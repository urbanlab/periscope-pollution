<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Periscope - Pollution de l'air - Urban LAB</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="description" content="Periscope - Pollution de l'air - Urban LAB Workshop DSAA Villefontaine">
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe-text-component/0.4.2/aframe-text-component.js"></script>
    <script src="https://rawgit.com/squarefeet/ShaderParticleEngine/master/build/SPE.js"></script>
    <script src="./js/aframe-animation-component.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js"></script>

    <script src='./js/pollution.js'></script>
    <script type="text/javascript" src='jsonPolluscope.json'></script>

    <script type="text/javascript" src="./json2html-master/json2html.js"></script> 

  </head>
  <body>
    
    <a-scene >
       <!--<a-entity particle-system="preset: snow" position="0 0 -10"></a-entity>-->
       <!--<a-entity position="0 2.25 -15" particle-system="preset: dust; texture: img/2.png; color: #0000FF,#00FF00,#FF0000"></a-entity>-->
      <!--<a-box id="bottom-plate" height="0.2" position="0 -0.5 0" color="#000000"></a-box>-->
      <a-assets>
        <!--Images du bouton start (cruseur) et du viseur pour les points d'intéret'-->
        <img id="start" crossorigin="anonymous" src="./img/play.png" >
        <img id="viseurAsset" crossorigin="anonymous" src="./img/viseur.png">
        <!--script pour récupérer l'ensemble des vidéos qui vont servir au projet'-->
        <script>
          var transformVideos = [
            {"<>":"video", "id":"${id}", "html":"", "src":"${chemin}", "loop": "${boucle}"},
          ];  
          var html = json2html.transform(videos, transformVideos);
          document.write(html);
        </script>
        <!--<video id="principale" src="./video/garibaldi.light.mp4" loop="true"></video>
        <video id="videoNoir" src="./video/fondNoir.mp4" loop="true"></video>
        <video id="video1" src="./video/room-before-action.mp4" loop="false"></video>
        <video id="video2" src="./video/room-after-action.mp4"  loop="false"></video>-->
      </a-assets>
      
      <!--Premier point intérêt fenêtre garibaldi-->
      <!--<a-plane
      id="pointInteretPrincipal1image"
      src="#viseurAsset"
      onclick="startScenario"
      position="-7 5 -1.7"
      width="1.5"
      height="1.5"
      rotation="0 60 0"
      transparent="false"
      segments-width="10">
      <a-animation easing="ease-in" attribute="scale"
          fill="backwards" repeat="indefinite" from="1 1 1" to="0.1 0.1 0.1" dur="1500"></a-animation>
      </a-plane>-->
      <script>
        var transformPrincipauxPOI = [
          {"<>":"a-entity","id":"${id}","html":[
            {"<>":"a-plane","id":"${id}"+"hidden","visible":"true", "position":"${position}","rotation":"${rotation}","width":"${largeur}","height":"${hauteur}","transparent":"true","opacity":"1","html":[
                {"<>":"a-image","id":"${id}"+"image","position":"0.05 0.05 0.05","src":"#viseurAsset","width":"2.5","height":"2.5","html":""},
                {"<>":"a-animation","attribute":"position","fill":"backwards","begin":"fusing","end":"mouseleave","direction":"alternate","repeat":"indefinite","to":"${hauteurAnimation}","dur":"600","html":""}
              ]}
          ]}
        ];
        var html = json2html.transform(principauxPOI, transformPrincipauxPOI);
        console.log(html);
        document.write(html);
      </script>
      <script>
        var transformScenariosPOI = [
          {"<>":"a-entity","id":"${id}","html":[
            {"<>":"a-plane","id":"${id}"+"hidden","visible":"false","position":"${position}","rotation":"${rotation}","width":"${largeur}","height":"${hauteur}", "transparent":"true","opacity":"0","html":[
                {"<>":"a-image","id":"${id}"+"image","position":"0.05 0.05 0.05","src":"#viseurAsset","width":"2.5","height":"2.5","html":""},
                {"<>":"a-animation","attribute":"position","fill":"backwards","begin":"fusing","end":"mouseleave","direction":"alternate","repeat":"indefinite","to":"${hauteurAnimation}","dur":"600","html":""}
              ]}
          ]}
        ];
        var html = json2html.transform(scenariosPOI, transformScenariosPOI);
        document.write(html);
      </script>
      <!--<a-entity id="pointInteretPrincipal1">
       <a-plane id="pointInteretPrincipal1hidden"
          visible="true"
          position="-7 5 -1.7"
          rotation="0 65 0"
          width="3.5"
          height="60"
          onclick="startScenario()"
          transparent="true"
          opacity="0">
            <a-image id="pointInteretPrincipal1image"  position="0.05 0.05 0.05" src="#viseurAsset" width="1.5" height="1.5"
            ></a-image> 
            <a-animation attribute="position" fill="backwards" begin="fusing" end="mouseleave" direction="alternate"
            repeat="indefinite" to="-7 6 -1.7" dur="600"></a-animation>

        </a-plane>
      </a-entity>
      <a-entity id="pointInteretScn1">
       <a-plane id="pointInteretScn1hidden"
          visible="false"
          position="10 3 3.9"
          rotation="0 -90 0"
          width="3.5"
          height="90"
          onclick="continueScenario()"
          transparent="true"
          opacity="0">
            <a-image id="pointInteretScn1image"  position="0.05 0.05 0.05" onclick="continueScenario()" src="#viseurAsset" width="2.5" height="2.5"
             ></a-image> 
            <a-animation attribute="position" fill="backwards" begin="fusing" end="mouseleave" direction="alternate"
            repeat="indefinite" to="10 4 3.9" dur="600"></a-animation> 
        </a-plane>
      </a-entity>
      <a-entity id="pointInteretPrincipal2">
       <a-plane id="pointInteretPrincipal2hidden"
          visible="true"
          position="-12 1.5 10"
          rotation="0 130 0"
          width="3.5"
          height="90"
          onclick="startScenario()"
          transparent="true"
          opacity="0">
            <a-image id="pointInteretPrincipal2image"  position="0.05 0.05 0.05" onclick="startScenario()" src="#viseurAsset" width="2.5" height="2.5"
             ></a-image> 
            <a-animation attribute="position" fill="backwards" begin="fusing" end="mouseleave" direction="alternate"
            repeat="indefinite" to="-12 2.5 10" dur="600"></a-animation> 
        </a-plane>
      </a-entity>
      <a-entity id="pointInteretPrincipal3">
       <a-plane id="pointInteretPrincipal3hidden"
          visible="true"
          position="0 7 17"
          rotation="0 170 0"
          width="3.5"
          height="90"
          onclick="startScenario()"
          transparent="true"
          opacity="0">
            <a-image id="pointInteretPrincipal3image"  position="0.05 0.05 0.05" src="#viseurAsset" width="2.5" height="2.5"
             rotation="0 0 0"></a-image> 
            <a-animation attribute="position" fill="backwards" begin="fusing" end="mouseleave" direction="alternate"
            repeat="indefinite" to="0 8 17" dur="600"></a-animation> 
        </a-plane>
      </a-entity>-->
                  <!--<a-animation easing="ease-in" attribute="scale" begin="fusing"
            repeat="2" fill="backwards" from="1 1 1" to="1 0.1 0.1" dur="1000"></a-animation> -->
      <!--<a-entity>
      <a-image id="pointInteretScn1image" src="#viseurAsset" onclick="continueScenario()" position="5 2.5 4" width="1.5" height="1.5" rotation="0 90 0" visible="false">
        <a-animation easing="ease-in" attribute="scale" begin="gogogo" end="stopit"
           repeat="indefinite" from="1 1 1" to="0.1 0.1 0.1" dur="1000"></a-animation>
      </a-image>
      </a-entity>-->
      <!--La voiture-->
      <!--<a-entity>
      <a-image id="pointInteretPrincipal2image" src="#viseurAsset" onclick="startScenario()" position="-12 1.5 10" width="2.5" height="2.5" rotation="0 130 0" visible="true">
        <a-animation easing="ease-in" attribute="scale" begin="gogogo" end="stopit"
           repeat="indefinite" from="1 1 1" to="0.1 0.1 0.1" dur="1000"></a-animation>
      </a-image>
      </a-entity>-->
      <!--L'industrie-->
      <!--<a-entity>
      <a-image id="pointInteretPrincipal3image" src="#viseurAsset" onclick="startScenario()" position="0 7 17" width="2.5" height="2.5" rotation="0 10 0" visible="true">
        <a-animation easing="ease-in" attribute="scale" begin="gogogo" end="stopit"
           repeat="indefinite" from="1 1 1" to="0.1 0.1 0.1" dur="1000"></a-animation>
      </a-image>
      </a-entity>-->
      <!--Génération des points d'intérêt de la scène principale'-->
      <!--<script>
        var transform = [
          {"<>":"a-image", "id":"${nom}", "html":"", "src":"#viseurAsset", "position": "${coord}", "onclick": "startScenario()", "width": "${largeur}", "height": "${hauteur}", "rotation": "${rotation}", "visible": "true"},
        ];  
        var html = json2html.transform(scene1POI, transform);
        document.write(html);
      </script>-->
      <!--Génération des points d'intérêt des autres scènes-->
      <!--<script>
        var transform2 = [
          {"<>":"a-image", "id":"${nom}", "html":"", "src":"#viseurAsset", "position": "${coord}", "onclick": "continueScenario()", "width": "${largeur}", "height": "${hauteur}", "rotation": "${rotation}", "visible": "false"},
        ];  
        var html = json2html.transform(scene2POI, transform2);
        document.write(html);
      </script>-->

      <!--Fenêtre "cliquable"-->
        <!--<a-plane id="pointInteretPrincipal1hidden"
          visible="true"
          position="-7 5 -1.7"
          rotation="0 25 0"
          width="2.5"
          height="40"
          onclick="startScenario()"
          >-->
          <!--<a-animation
            attribute="material.opacity"
            from="0"
            to="0"
            dur="1000"
            repeat="indefinite"
            >
          </a-animation>-->
        <!--</a-plane>-->
        <!--Fenêtre "cliquable"-->
        <!--<a-plane id="pointInteretScn1hidden"
          visible="false"
          position="100 10 3.9"
          rotation="0 -90 0"
          width="65"
          height="180"
          color="#FFF"
          onclick="continueScenario()"
          >
          <a-animation
            attribute="material.opacity"
            from="0"
            to="0"
            dur="1000"
            repeat="indefinite"
            >
          </a-animation>
        </a-plane>
        <a-plane id="pointInteretPrincipal2hidden"
          visible="true"
          position="-12 1.5 10"
          rotation="0 130 0"
          width="2.5"
          height="50"
          color="#FFF"
          onclick="startScenario()"
          >
          <a-animation
            attribute="material.opacity"
            from="0"
            to="0"
            dur="1000"
            direction="alternate"
            repeat="indefinite"
            >
          </a-animation>
        </a-plane>-->
        <!--<a-plane id="pointInteretPrincipal3hidden"
          visible="true"
          position="0 7 17"
          rotation="0 130 0"
          width="2.5"
          height="50"
          color="#FFF"
          onclick="startScenario()"
          >
          <a-animation
            attribute="material.opacity"
            from="0"
            to="0"
            dur="1000"
            direction="alternate"
            repeat="indefinite"
            >
          </a-animation>
        </a-plane>-->
        
       <!--Spacing. 
      <a-entity mixin="marker" position="-1 2.5 0.01"></a-entity>
      <a-entity id="texteFondu" visible="false" position="-1 2.5 0"
                text="width: 2+; color: red; value: Ici le texte d'introduction pour l'entree dans l'appartement par exemple!'">
      </a-entity>

      <a-entity id="please" position="0 2.2 4" visible="false" position="-1 2.5 0"
                text="width: 2+; color: red; value: Ici le texte d'introduction pour l'entree dans l'appartement par exemple!'">
      </a-entity>-->



      <!-- START button : play videos -->
      <a-entity position="0 2.2 4" camera look-controls wasd-controls >
        <a-plane
           position="0 0 -3"
           width="1"
           height="1"
           color="#FFF"
           shader: flat;
           cursor="fuse: true; fuse-timeout: 3000"
           src="#start"
           id="playVideos"
           transparent="true"
           visible="true"
          >
          <!--<a-animation
            attribute="material.opacity"
            direction="alternate"
            from="0"
            to="1"
            dur="3000"
            repeat="indefinite"
            >
          </a-animation>--> 
          <!--Ca marche pas sur le a-text ngga  -->
          <!--TODO: begin="fadeIn" ou fadeOut pour la lancer une fois et que ca tourne pas en boucle pour le texte-->
        </a-plane>
        <a-plane>
        <a-text 
        value="Suis-je a l'abri a l'interieur de mon logement?"
        position="0 0 -8"
        align="center"
        width="7"
        height="10"
        color="white"
        font-family="Lucida Sans Unicode"
        shader: flat;
        id="questionScene1"
        visible="false"
        >
        </a-text>
        <a-text 
        value="Notre habitat regorge de differentes sources de pollution: materiaux, activite humaine...Pensez a aerer votre logement en moyenne 15 minutes le matin ou en soiree "
        position="0 0 -8"
        align="center"
        width="7"
        height="10"
        font-family="Lucida Sans Unicode"
        color="white"
        shader: flat;
        id="reponseScene1"
        visible="false"
        >
        </a-text>
        <a-text 
        value="Niveau de pollution"
        position="11 -4 -8"
        align="center"
        width="10"
        height="10"
        font-family="Lucida Sans Unicode"
        color="red"
        shader: flat;
        id="niveauPollution"
        visible="true"
        >
        </a-text>

        </a-entity>


      <!-- CURSOR -->
     <!--<a-entity position="0 2.2 4" camera look-controls wasd-controls>
       <a-plane
         position="0 0 -3"
         width=".5"
         height=".5"
         color="#FFF"
         cursor="fuse: true"
         src="#viseurAsset"
         id="viseur"
         transparent="true"
         visible="false"
         >
         <a-animation begin="click" easing="ease-in" attribute="scale"
              fill="forwards" from="0.1 0.1 0.1" to="1 1 1" dur="150"></a-animation>
         <a-animation begin="fusing" easing="ease-in" attribute="scale"
              fill="backwards" from="1 1 1" to="0.1 0.1 0.1" dur="1500"></a-animation>
     </a-plane>
    </a-entity>-->

      <!-- POLLUTION  -->
      <a-entity
        id="pollution"
        pollution="count:10000;multiplier:0.1;speed:0.05"
        >
      </a-entity>

      <!-- garibaldi -->
      <a-entity id="sceneRue" class="scene" visible="true">
        <a-videosphere
          id="videoPlayerGaribaldi"
          src="#principale"
          rotation="0 0 0"
          autoplay="false"
          class="playable"
          >
        </a-videosphere>
         <!--<a-sky src="https://maps.googleapis.com/maps/api/streetview?size=640x640&location=pole pixel villeurbanne
&fov=120&heading=235&pitch=0
&key=AIzaSyAw3_wsSoV7-AvVlRxO0dqcMEcHNq2hEA8" rotation="0 -130 0"></a-sky>-->
        <!--<a-sky src="./img/RIEN.png" rotation="0 -130 0" visible="fasle"></a-sky>-->
        <!-- LA PORTE -->
        <!--<a-entity
          id="porte"
          obj-model="obj: #porte-obj; mtl: #porte-mtl"
          position="5 2 -12"
          rotation="0 -15 0"
          scale=".001 .001 .001"
          onclick="startScenario()"
          visible="true"
        >
        </a-entity>-->
      </a-entity>
      <!-- tentative de fondu texte -->
      <!-- interior -->
      <a-entity id="sceneRoom" class="scene" visible="true">
        <a-videosphere
          id="videoSceneRoomBeforeAction"
          src="#video1"
          visible="false"
          autoplay="false"
          rotation="0 0 0"
          >
        </a-videosphere>
        <a-videosphere
          id="videoSceneNoir"
          src="#videoNoir"
          autoplay="false"
          visible="false"
          rotation="0 0 0"
          >
        </a-videosphere>
        <a-videosphere
          id="videoSceneRoomAfterAction"
          src="#video2"
          visible="false"
          autoplay="false"
          rotation="0 0 0"
          >
        </a-videosphere>

        <!--Fenêtre "cliquable"-->
        <!--<a-plane id="hidden-window"
          visible="false"
          position="100 10 3.9"
          rotation="0 -90 0"
          width="65"
          height="98"
          color="#FFF"
          onclick="playAfterSceneRoom()"
          >
          <a-animation
            attribute="material.color"
            from="cyan"
            to="cyan"
            dur="1000"
            direction="alternate"
            repeat="indefinite"
            >
          </a-animation>
          <a-animation
            attribute="material.opacity"
            from="0"
            to=".5"
            dur="1000"
            direction="alternate"
            repeat="indefinite"
            >
          </a-animation>
        </a-plane>-->

      <script type="text/javascript">

        // var inited = false;

        // document.addEventListener("touchend", initVideos)

        // // play and pause all videos
        // function initVideos() {

        //   var videos = document.querySelectorAll('video')
        //   console.log("click screen");
        //   if(!inited && videos.length) {
        //     console.log("init");
        //     inited = true;

        //     for(var i = 0; i < videos.length; i++) {
        //       videos[i].play();
        //     }

        //     setTimeout( function () {
        //       for(var i = 0; i < videos.length; i++) {
        //         videos[i].pause();
        //       }
        //       document.getElementById('principale').play()
        //       document.getElementById('playVideos').setAttribute('visible', false);
        //       showCursor()

        //       //document.getElementById('porte').setAttribute('visible', true);
        //       document.removeEventListener("touchend", initVideos)
        //     },1000);
        //   }
        // }

        // function hideAllScenes() {
        //   var scenes = document.getElementsByClassName('scene')
        //   for(var i = 0; i < scenes.length; i++) {
        //     scenes[i].setAttribute('visible', 'false')
        //   }

        //   // hide pollution
        //   var pollution = document.getElementById("pollution")
        //   pollution.setAttribute("pollution", {"multiplier" : 0})

        // }

        function setPollution(x) {
          var pollution1 = document.getElementById("pollution")
          pollution1.setAttribute("pollution", {"multiplier" : x})
        }

        // function showCursor() {
        //   document.getElementById('viseur').setAttribute('visible', false); //était à true. masqué pour corriger bug quand retour scène rue?
        // }

        // function hideCursor() {
        //   document.getElementById('viseur').setAttribute('visible', false);
        // }

        // function showSceneRue() {
        //   hideAllScenes() // reset
        //   document.getElementById("sceneRue").setAttribute('visible', true)
        //   //document.getElementById("porte").setAttribute('visible', true)
        //   var pollution = document.getElementById("pollution")           //ajouté
        //   pollution.setAttribute("pollution", {"multiplier" : 0.1})      //règle le bug de l'absence d epollution en retour sur rue'
        // }

        

        // function playFondu() {
        //   //document.getElementById('videoNoir').play();
        //   var pollutionEl = document.getElementById("pollution")
        //   //pollutionEl.emit("pollutionFadeIn") // start the animation
        //   pollutionE1.setAttribute("pollution", {"multiplier" : 0}) 
        //   document.getElementById('roomTexte').setAttribute('visible', true);
        // }
        // function playBeforeSceneRoom() {
        //   console.log('room : part 1');
        //   document.getElementById('video1').currentTime = 0
        //   document.getElementById('fondNoirScene').setAttribute('visible', 'false')
        //   document.getElementById('videoSceneRoomBeforeAction').setAttribute('visible', 'true')
        //   document.getElementById('video1').play();
        //   var pollutionEl = document.getElementById("pollution")
        //   pollutionEl.emit("pollutionFadeIn") // start the animation
        // }

        // function playAfterSceneRoom() {
        //   console.log('room : part 2');
        //   // hide window and play 2nd video
        //   document.getElementById('pointInteretScn1hidden').setAttribute('visible', false);
        //   document.getElementById('pointInteretScn1image').setAttribute('visible', false);
        //   document.getElementById('video2').currentTime = 0
        //   document.getElementById('videoSceneRoomBeforeAction').setAttribute('visible', 'false')
        //   document.getElementById('video2').play()
        //   document.getElementById('videoSceneRoomAfterAction').setAttribute('visible', 'true')
        //   document.getElementById('videoPlayerGaribaldi').setAttribute('visible', 'false')

        //   // remove pollution
        //   var video = document.getElementById('video2');
        //   video.addEventListener('ended', function (evt) {
        //     var pollutionEl = document.getElementById("pollution")
        //     pollutionEl.emit("pollutionFadeOut")
        //   });
        // }

        function startScenario() {
          // show scene
          //hideAllScenes()
          setPollution(0.0)
          document.getElementById('videoNoir').currentTime = 0
          launchQuestion()
          var sceneEl = document.getElementById("videoSceneNoir")
          sceneEl.setAttribute('visible', 'true')
          setTimeout(function(){
              sceneEl.setAttribute('visible', 'false')
              document.getElementById('video1').currentTime = 0
              hideQuestion()
              var sceneE2 = document.getElementById("videoSceneRoomBeforeAction")
              sceneE2.setAttribute('visible', 'true')
              setPollution(0.5)
              document.getElementById('video1').play()
          }, 5000);
          
          //document.getElementById('videoSceneRoomBeforeAction').play()
          hideCursor()

          // play scene
          //initSceneRoom()
          //playFondu()
        }

        function continueScenario() {
           console.log('room : part 2');
          // cache les points d'intérêt'
          document.getElementById('playVideos').setAttribute('visible', false);
          //document.getElementById('video2').currentTime = 0
          document.getElementById('pointInteretScn1hidden').setAttribute('visible', false);
          document.getElementById('pointInteretScn1image').setAttribute('visible', false);          
          document.getElementById('videoSceneRoomBeforeAction').setAttribute('visible', 'false')
          document.getElementById('video2').play()
          document.getElementById('videoSceneRoomAfterAction').setAttribute('visible', 'true')
          document.getElementById('videoPlayerGaribaldi').setAttribute('visible', 'true')
        }

        function finishScenario(e) {
          setPollution(0.0)
          document.getElementById('videoSceneRoomAfterAction').setAttribute('visible', 'false')
          document.getElementById('videoNoir').currentTime = 0
          launchReponse()
          var sceneEl = document.getElementById("videoSceneNoir")
          sceneEl.setAttribute('visible', 'true')
          setTimeout(function(){
              sceneEl.setAttribute('visible', 'false')
              document.getElementById('principale').currentTime = 0
              hideReponse() //remet aussi les points d'intéret de départ'
              var sceneE2 = document.getElementById("videoPlayerGaribaldi")
              sceneE2.setAttribute('visible', 'true')
              document.getElementById('principale').play()
              setPollution(0.1)
          }, 5000);
        }

        function launchQuestion() { 
          document.getElementById('pointInteretPrincipal1hidden').setAttribute('visible', false);
          document.getElementById('pointInteretPrincipal2hidden').setAttribute('visible', false);
          document.getElementById('pointInteretPrincipal3hidden').setAttribute('visible', false);
          document.getElementById('pointInteretPrincipal1image').setAttribute('visible', false);
          document.getElementById('pointInteretPrincipal2image').setAttribute('visible', false);
          document.getElementById('pointInteretPrincipal3image').setAttribute('visible', false);
          document.getElementById('playVideos').setAttribute('visible', false);
          document.getElementById('niveauPollution').setAttribute('visible', false);
          document.getElementById('questionScene1').setAttribute('visible', true);
        }

        function launchReponse() { 
          document.getElementById('playVideos').setAttribute('visible', false);
          document.getElementById('reponseScene1').setAttribute('visible', true);
        }

        function hideQuestion() { 
          document.getElementById('pointInteretScn1hidden').setAttribute('visible', true);
          document.getElementById('pointInteretScn1image').setAttribute('visible', true);
          document.getElementById('playVideos').setAttribute('visible', true);
          document.getElementById('questionScene1').setAttribute('visible', false);
        }

        function hideReponse() { 
          document.getElementById('pointInteretPrincipal1hidden').setAttribute('visible', true);
          document.getElementById('pointInteretPrincipal2hidden').setAttribute('visible', true);
          document.getElementById('pointInteretPrincipal3hidden').setAttribute('visible', true);
          document.getElementById('pointInteretPrincipal1image').setAttribute('visible', true);
          document.getElementById('pointInteretPrincipal2image').setAttribute('visible', true);
          document.getElementById('pointInteretPrincipal3image').setAttribute('visible', true);
          document.getElementById('playVideos').setAttribute('visible', true);
          document.getElementById('niveauPollution').setAttribute('visible', true);
          document.getElementById('reponseScene1').setAttribute('visible', false);
        }

        // begin="gogogo" dans l'animation'
        // function startAnim(e) {
        //   var thatE1 = document.getElementById('pointInteretPrincipal1image');
        //   console.log("gogogo lancé pour 1");
        //   thatE1.emit("gogogo");
        // }

        // end="stopit"
        // function stopAnim(e) {
        //   var thatE1 = document.getElementById('pointInteretPrincipal1image');
        //   console.log("fin de fusing");
        //   thatE1.emit("stopit");
        //   thatE1.setAttribute('width',1.5);
        //   thatE1.setAttribute('height',1.5);
        // }
        // for(i=1; i<5; i++){
        //   document.getElementById('hiddenpointInteret'+i).addEventListener('fusing',startAnim,false);
        //   document.getElementById('hiddenpointInteret'+i).addEventListener('mouseleave',stopAnim,false);
        // }

        // events
        // MyEvents
        document.getElementById('video2').addEventListener('ended',finishScenario,false);
        for(var i=1;i<=principauxPOI.length; i++){
          document.getElementById('pointInteretPrincipal'+i+"hidden").addEventListener('click',startScenario,false);
        }
        for(var j=1;j<=scenariosPOI.length; j++){
          document.getElementById('pointInteretScn'+j+"hidden").addEventListener('click',continueScenario,false);
        }
        // document.getElementById('pointInteretPrincipal1hidden').addEventListener('fusing',startAnim, false);
        // document.getElementById('pointInteretPrincipal1hidden').addEventListener('mouseleave',stopAnim,false);
        
        
        //end of my events
        //pour ne pas qu'elle tourne une fois "toute seule" et que ca declenche involontairement l'event de fin de vidéo u_u
        document.getElementById('video2').pause();
        //Chargement du json
        // var text = '{"employees":[' +
        // '{"firstName":"John","lastName":"Doe" },' +
        // '{"firstName":"Anna","lastName":"Smith" },' +
        // '{"firstName":"Peter","lastName":"Jones" }]}';
        

        // obj = JSON.parse(text);
        // document.getElementById('questionScene1').setAttribute('value', points_interet[1].nom);
        
        // var sceneEl = document.getElementById("sceneRoom")

        // sceneEl.addEventListener('pollutionReady', function () {
        //   console.log("pollution is ready !");
        //   // show window
        //   document.getElementById("hidden-window").setAttribute("visible", true)
        //   document.getElementById("roomTexte").setAttribute("visible", true)
        //   showCursor()
        // });

        // sceneEl.addEventListener('pollutionFinished', function () {
        //   console.log("pollution is finished !");
        //   showSceneRue()
        // });

      
      

      </script>
    </a-scene>
  </body>
</html>
